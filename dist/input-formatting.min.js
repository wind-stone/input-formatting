!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.InputFormatting={})}(this,function(t){"use strict";var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),i=function(){function t(n,i){e(this,t),n.constructor!==String&&(this.initData(n,i),this.addInputHandler(),n.value&&this.formatOnly())}return n(t,[{key:"initData",value:function(t,e){this.options=e,this.input=t;var n=e.formatString,i=e.separatorReg,a=n.split(""),r=this.separatorIndexArray=[];t.maxLength=n.length,a.forEach(function(t,e){i.test(t)&&r.push({index:e,value:t})})}},{key:"formatOnly",value:function(){var t=this,e=this.input,n=this.options.separatorReg,i=e.value.replace(n,"").split("");this.formattedValue=formatter(i,this.separatorIndexArray),setTimeout(function(){e.value=t.formattedValue,t.lastInputLength=e.value.length})}},{key:"addInputHandler",value:function(){var t=this,e=this.options,n=this.input,i=e.separatorReg,a=e.beforeFormat;this.lastInputLength=0,this.lastSelectionStart=0;var r=void 0;this.inputHandler=function(){var e=n.value.length,o=t.lastInputLength<e,u=n.value.replace(i,"").split(""),l=t.separatorIndexArray,s=n.selectionStart;if(void 0===r&&o&&(r=1===e&&0===s||t.lastSelectionStart===s),o&&r&&s++,a&&"function"==typeof a){var f=u.join("");if(!1===a.call(t,f))return}if(e-t.lastInputLength>1){t.formatOnly();var p=+n.getAttribute("maxlength");return setTimeout(function(){n.setSelectionRange(p,p)})}l.forEach(function(t){u.length<=t.index||(o?s===t.index+1&&s++:s===t.index&&(u.splice(t.index-1,1),s--),t.index<u.length&&u.splice(t.index,0,t.value))}),n.value=t.formattedValue=u.join(""),t.lastInputLength=u.length,o&&s<n.value.length&&l.some(function(t){if(t.index===s)return s++,!0}),t.lastSelectionStart=s,setTimeout(function(){n.setSelectionRange(s,s)})},n.addEventListener("input",this.inputHandler,!1)}},{key:"removeInputHandler",value:function(){this.inputHandler&&this.input.removeEventListener("input",this.inputHandler)}},{key:"resetInputHandler",value:function(t){this.input.value=this.formattedValue="",this.initData(this.input,t),this.removeInputHandler(),this.addInputHandler()}}]),t}();t.default=i,t.formatter=function(t,e){return e.forEach(function(e){t.length<=e.index||e.index<t.length&&t.splice(e.index,0,e.value)}),t.join("")},Object.defineProperty(t,"__esModule",{value:!0})});
